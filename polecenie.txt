Wprowadzenie

Rozważamy realizację kalkulatora wykonującego polecenia o składni opisanej
gramatyką z symbolem początkowym Polecenie:

Polecenie → ε | Polecenie Instrukcja
Instrukcja → # | @ Zmienna | ^ Zmienna | \ Zmienna | Zmienna Zmienna | (
Polecenie ) | Licznik Instrukcja
Zmienna → a | b | c | d | e | f | g | h | i | j | k | l | m | n | o | p
Licznik → 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9

Wykonanie polecenia powoduje wykonanie, w kolejności od pierwszej do
ostatniej, wszystkich jego instrukcji. Semantyka instrukcji jest następująca:

#
wypisuje aktualny stan pamięci,

@ Zmienna
wypisuje wartość zmiennej,

^ Zmienna
dodaje 1 do wartości zmiennej,

\ Zmienna
nadaje zmiennej wartość 0,

Zmienna Zmienna
dodaje do pierwszej zmiennej wartość drugiej zmiennej (np. ab działa tak, jak
a := a + b w Pascalu),

( Polecenie )
wykonuje polecenie ujęte w nawiasy,

Licznik Instrukcja
powtarza wykonanie instrukcji liczbę razy określoną licznikiem.
Kalkulator ma pamięć złożoną z 816 10-bitowych bajtów (uwaga: bajt nie jest tu
oktetem, czyli ósemką bitów). Pamięć jest podzielona na 51 logicznych bloków,
po 16 bajtów w każdym, numerowanych od 0 do 50. W chwili uruchomienia
kalkulatora, pamięć jest wyzerowana.

Wartości 16 zmiennych występujących w poleceniach, będące nieujemnymi liczbami
całkowitymi, są przechowywane w pamięci w zapisie pozycyjnym o podstawie 1000,
po jednej cyfrze w bajcie. Dla każdej zmiennej, odpowiedni bajt bloku zerowego
(zerowy dla a, pierwszy dla b itd.) określa jej wartość. Jeśli zmienna ma
wartość 0, to w odpowiadającym jej bajcie bloku zerowego jest 0, w przeciwnym
przypadku jest tam numer bloku reprezentującego wartość zmiennej.

W 15 początkowych bajtach bloku reprezentującego niezerową wartość W są cyfry
zapisu wartości W mod (1000^15), uporządkowane w kolejności od najmniej
znaczących. Jeśli W jest mniejsze od 1000^15, ostatni bajt bloku
reprezentującego W jest zerowy. W przeciwnym przypadku, jego wartością jest
numer bloku reprezentującego wartość W div (1000^15). W ostatnim bloku
reprezentacji wartości W, czyli w tym, którego ostatni bajt jest zerowy, musi
więc być przynajmniej jedna cyfra niezerowa.

Kalkulator zarządza pulą wolnych bloków. Początkowo są w niej wszystkie bloki
o niezerowych numerach. Gdy, podczas dodawania w kolejności od najmniej
znaczących cyfr, okaże się, że aktualizacja wartości zmiennej wymaga
uzupełnienia jej reprezentacji o kolejny blok, z puli wolnych pobierany jest
blok o najniższym numerze. Wykonanie instrukcji \ zerującej zmienną dołącza do
puli wolnych wszystkie bloki reprezentujące jej wartość. Zwalniane bloki nie
są przy tym zerowane.

Polecenie

Napisz program symulujący działanie kalkulatora. Program powinien wyzerować
pamięć a następnie wczytywać z wejścia i wykonywać kolejne polecenia,
odpowiednio modyfikując pamięć i wypisując wyniki na wyjście. Program zakończy
działanie po wczytaniu polecenia pustego.

Postać danych i wyniku

Danymi programu jest ciąg wierszy, w każdym po jednym poleceniu, zakończony
wierszem pustym. W wierszach poleceń występują tylko znaki, będące symbolami
końcowymi gramatyki. W szczególności, nie ma w nich spacji.

Program wypisuje wartość zmiennej w postaci wiersza z ciągiem cyfr jej zapisu
dziesiętnego, w kolejności od najbardziej znaczących, bez zer wiodących.
Wartość 0 jest więc reprezentowana przez cyfrę zero a wartości niezerowe
zaczynają się od cyfry niezerowej.

Stan pamięci wypisywany jest w postaci ciągu wierszy, po jednym dla każdego
bloku, zawierających wartości bajtów danego bloku. Wartość bajtu jest zapisana
na czterech znakach, z wyrównaniem do prawej. Dodatkowo, na początku każdego
wiersza zapisu stanu pamięci jest numeru bloku, na dwóch znakach, z
wyrównaniem do prawej, oraz dwukropek.

Przykłady

Dla danych:

#
^a5(^b@b)
cacbcb@c
\b@b#
@d99^d#


program powinien wypisać:

 0:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 2:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 5:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 7:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 8:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 9:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
10:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
11:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
12:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
13:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
14:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
15:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
16:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
17:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
18:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
19:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
20:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
21:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
22:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
23:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
24:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
25:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
26:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
27:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
28:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
29:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
30:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
31:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
32:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
33:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
34:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
35:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
36:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
37:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
38:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
39:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
40:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
41:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
42:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
43:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
44:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
45:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
46:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
47:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
48:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
49:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
50:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
1
2
3
4
5
11
0
 0:   1   0   3   0   0   0   0   0   0   0   0   0   0   0   0   0
 1:   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 2:   5   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 3:  11   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 5:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 7:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 8:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 9:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
10:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
11:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
12:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
13:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
14:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
15:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
16:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
17:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
18:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
19:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
20:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
21:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
22:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
23:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
24:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
25:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
26:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
27:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
28:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
29:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
30:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
31:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
32:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
33:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
34:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
35:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
36:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
37:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
38:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
39:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
40:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
41:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
42:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
43:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
44:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
45:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
46:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
47:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
48:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
49:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
50:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
0
 0:   1   0   3   2   0   0   0   0   0   0   0   0   0   0   0   0
 1:   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 2:  81   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 3:  11   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 5:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 7:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 8:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 9:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
10:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
11:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
12:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
13:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
14:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
15:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
16:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
17:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
18:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
19:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
20:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
21:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
22:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
23:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
24:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
25:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
26:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
27:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
28:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
29:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
30:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
31:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
32:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
33:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
34:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
35:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
36:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
37:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
38:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
39:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
40:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
41:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
42:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
43:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
44:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
45:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
46:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
47:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
48:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
49:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
50:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Dla danych:

^b8555(abba)#@a@b
\aab#


program powinien wypisać:

 0:   2   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 1: 626 822 592 496 221 418 573 401 912  30 370 941 978 448 990   3
 2: 125 817 516  82 312 204  25 324 930 881 717 171 554 404 665   4
 3: 114 759 141 761 725 115 972 121 752 383 720 146 565 954 422   5
 4: 802 612 155 720 448 977 841 499 806 529  69 656 652  87 972   6
 5: 538  89  85 952 151 819 819 214 740 545 539 976 400 893 699   8
 6: 562 349 515 139 480 964 347 243 295 422 654  23 884 722  86   7
 7: 369 597 264 876 870 468 311 858 879 719 886 497 615  11 607  10
 8: 869 575 253 494 101 947 516 842 629 954 897 735 487 135 634   9
 9: 685  44 731 148 579 355 529 433 914 704 264 868 104 528  95  11
10:  60 778 716 833 901 263 992 472 482 874 982 316 795 256 722  12
11: 767 453 296 637 813 901  90 664 705 819 414 105 405 101 306  14
12: 998 904 453 492 229 915 585 991 606 802 555 253 326 737 598  13
13: 312 983 271  29 596 643 711 194 640 607 603 909 538  87 446  16
14: 338 943 939 677 526 714 192 192 238 478 447 523 769 726 603  15
15: 726 802 113 953 318 534 954  14  54 408 454  82 798 367 553  17
16:  88 511 141 639 599 123 224 707 130 370 584 308 314 137 280  18
17: 407 565 524 365  29 408  55 107 580 170 549 396  45 647 806  20
18:  10  98 681 250 840 852 579 782 482 341 602 725 706 878 304  19
19: 392 333 696 224   4   0   0   0   0   0   0   0   0   0   0   0
20: 575 259 702 835   6   0   0   0   0   0   0   0   0   0   0   0
21:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
22:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
23:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
24:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
25:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
26:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
27:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
28:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
29:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
30:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
31:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
32:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
33:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
34:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
35:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
36:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
37:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
38:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
39:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
40:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
41:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
42:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
43:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
44:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
45:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
46:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
47:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
48:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
49:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
50:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
4224696333392304878706725602341482782579852840250681098010280137314308584370130707224123599639141511088446087538909603607640194711643596029271983312598737326253555802606991585915229492453904998722256795316982874482472992263901833716778060607011615497886719879858311468870876264597369086722884023654422295243347964480139515349562972087652656069529806499841977448720155612802665404554171717881930324025204312082516817125
6835702259575806647045396549170580107055408029365524565407553367798082454408054014954534318953113802726603726769523447478238192192714526677939943338306101405105414819705664090901813637296453767095528104868264704914433529355579148731044685634135487735897954629842516947101494253575869699893400976539545740214819819151952085089538422954565146720383752121972115725761141759114990448978941370030912401573418221496592822626
 0:   2   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 1: 626 822 592 496 221 418 573 401 912  30 370 941 978 448 990   3
 2: 626 822 592 496 221 418 573 401 912  30 370 941 978 448 990   4
 3: 114 759 141 761 725 115 972 121 752 383 720 146 565 954 422   5
 4: 114 759 141 761 725 115 972 121 752 383 720 146 565 954 422   6
 5: 538  89  85 952 151 819 819 214 740 545 539 976 400 893 699   8
 6: 538  89  85 952 151 819 819 214 740 545 539 976 400 893 699   7
 7: 869 575 253 494 101 947 516 842 629 954 897 735 487 135 634  10
 8: 869 575 253 494 101 947 516 842 629 954 897 735 487 135 634   9
 9: 685  44 731 148 579 355 529 433 914 704 264 868 104 528  95  11
10: 685  44 731 148 579 355 529 433 914 704 264 868 104 528  95  12
11: 767 453 296 637 813 901  90 664 705 819 414 105 405 101 306  14
12: 767 453 296 637 813 901  90 664 705 819 414 105 405 101 306  13
13: 338 943 939 677 526 714 192 192 238 478 447 523 769 726 603  16
14: 338 943 939 677 526 714 192 192 238 478 447 523 769 726 603  15
15: 726 802 113 953 318 534 954  14  54 408 454  82 798 367 553  17
16: 726 802 113 953 318 534 954  14  54 408 454  82 798 367 553  18
17: 407 565 524 365  29 408  55 107 580 170 549 396  45 647 806  20
18: 407 565 524 365  29 408  55 107 580 170 549 396  45 647 806  19
19: 575 259 702 835   6   0   0   0   0   0   0   0   0   0   0   0
20: 575 259 702 835   6   0   0   0   0   0   0   0   0   0   0   0
21:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
22:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
23:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
24:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
25:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
26:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
27:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
28:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
29:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
30:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
31:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
32:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
33:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
34:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
35:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
36:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
37:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
38:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
39:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
40:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
41:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
42:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
43:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
44:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
45:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
46:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
47:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
48:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
49:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
50:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Dla danych:

^a8555(7aa)#
\a^a@a34(8555baab@a\b)#


program powinien wypisać:

 0:   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 1: 376 829 553 902 440  28 892 390 562 888 439 783 720 583 280   2
 2: 598 561 316 443 116 714 406 362  92 369  16 253 918 950 245   3
 3: 762 804 895 370 162 589 329 246 711 353 803 573 220 811 407   4
 4: 809 468   9 810 101 455 313 741 780 517 437 955 726 202 656   5
 5: 363  26 417 177 789 407 603 710 535 483 355 868 384 795 229   6
 6: 921 302 122 627 163 832 888 343 547  29 921 382 826 375 161   7
 7: 588 696 584  99  26 152 388 124 832 606 704 741 820 839 580   8
 8:  18 156 469 969 229 899 772 550  64 131 661 218 328 326 112   9
 9: 288 354 600 245 737 403 999   4 680 113 464 798 334 135 884  10
10: 518 830 955  89 930 747 973 532 441 117 135  39 355 742 717  11
11: 990  91 290  76 493 112 652  44 688 621 546  69 887 954 237  12
12: 807 604 839  92 320 108 625 853 977 790 370 949 172 415 920  13
13: 875 202 237 339 396 549  71 752 539 838 969 509 621  49 703  14
14: 914  18 775 807 673 325 409 238 800 386 888 568 213 661 593  15
15: 897 696 193 767 505 858 183 400 904  29 268 870 453 119 124  16
16: 256 355 211  89 176 632 402  76 490 233 724 144 777 854 255  17
17:  82 859 672 449 510 777 406 751 750 211 199 575 955 176 216  18
18: 457 461 175 276 801 950 484  66 609 185 658 660 174 327 657  19
19: 665 668 531 548 428  63  47 689 593 978 208 907 488  49 203  20
20: 705 762  74 261 621 709 685 487 263 662 144  27 507 547 567  21
21: 776  73 655 757 427 460 203 292 838 304 897  67 864 682 510  22
22: 811 603 802 515 743 215 384 749 404 681 991 997 398 980 600  23
23: 176 654 819 292 552 818 784 788 297 216 431 291 567  79 591  24
24: 512 660 386 435 935 244 790 334 355 706 907 877  29 257 839  25
25: 994 535 597 517  22 122 422 127 373 287 842 782 296 984 767  26
26: 521 484 501 617 134 189 411 167 805 743   0 737 631 195 858  27
27: 108 537 485 258 195 845 897  75 530 183 302 972 633 169 420  28
28: 712  79 913 106 252 173 980 400  17 298 904 306 895 803 659  29
29: 234  32 991 202 839 899  73 357 833  24 560 479 294 301 937  30
30: 367 995 211 396 931 242  84 573  90 416 714 994 349 240 156  31
31: 491 360 255 601 277 192 964 895 958  99  24 854 811 857 302  32
32: 476 538 919 280  87 829  43 127 125 510 514 197 415 802 993  33
33: 941 369 248  88 876 344 414 575 375 696 890 570 528 709 699  34
34: 812 892 493 808  21 682 662 526 336  25 597 172 904 790 701  35
35: 561 666 557 594 343 159 104 616 753 353 874 925 429 122 838  36
36: 539  73  22 155 170 942 186  37 754  88 402 417 120 674 440  37
37: 434 847 684 529 121 619 438 473 569 112 574 939 592 683  94  38
38: 478 889 507  96 509 509 772 554 214 544  54  59 235 955 293  39
39: 311  52 246  17 275 423 908 626  18  11 874 520  43 492 747  40
40: 328 971 160   8 626  88 161 402 186 272 446 938  92 558 780  41
41: 566 572 947 552   6 377 552 962 781 678 296 579 817 209  11  42
42: 660   6 436 169 860 996  99 125 784  77 392 266 484 194  43  43
43: 617  82 931  72 260 878 281  12 420 722 842 842 340 373 599  44
44:  76 227 585 431 647 658 564 253 110  22 107 204 513 546 892  45
45: 557 652 538 984 530  99  19 996 651   4 460 794 378 802 870  46
46: 529  23 627 231 270 515 841 820 359 562 432 637 303 124 911  47
47: 951 770 783 854 650 666 264  20 622 556 967 216  16   0   0   0
48:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
49:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
50:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
1
1001
1002001
1003003001
1004006004001
1005010010005001
1006015020015006001
1007021035035021007001
1008028056070056028008001
1009036084126126084036009001
1010045120210252210120045010001
1011055165330462462330165055011001
1012066220495792924792495220066012001
 0:   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
 1:   1  12  66 220 495 792 924 792 495 220  66  12   1   0   0   0
 2:   0   1  11  55 165 330 462 462 330 165  55  11   1   0   0   0
 3: 762 804 895 370 162 589 329 246 711 353 803 573 220 811 407   4
 4: 809 468   9 810 101 455 313 741 780 517 437 955 726 202 656   5
 5: 363  26 417 177 789 407 603 710 535 483 355 868 384 795 229   6
 6: 921 302 122 627 163 832 888 343 547  29 921 382 826 375 161   7
 7: 588 696 584  99  26 152 388 124 832 606 704 741 820 839 580   8
 8:  18 156 469 969 229 899 772 550  64 131 661 218 328 326 112   9
 9: 288 354 600 245 737 403 999   4 680 113 464 798 334 135 884  10
10: 518 830 955  89 930 747 973 532 441 117 135  39 355 742 717  11
11: 990  91 290  76 493 112 652  44 688 621 546  69 887 954 237  12
12: 807 604 839  92 320 108 625 853 977 790 370 949 172 415 920  13
13: 875 202 237 339 396 549  71 752 539 838 969 509 621  49 703  14
14: 914  18 775 807 673 325 409 238 800 386 888 568 213 661 593  15
15: 897 696 193 767 505 858 183 400 904  29 268 870 453 119 124  16
16: 256 355 211  89 176 632 402  76 490 233 724 144 777 854 255  17
17:  82 859 672 449 510 777 406 751 750 211 199 575 955 176 216  18
18: 457 461 175 276 801 950 484  66 609 185 658 660 174 327 657  19
19: 665 668 531 548 428  63  47 689 593 978 208 907 488  49 203  20
20: 705 762  74 261 621 709 685 487 263 662 144  27 507 547 567  21
21: 776  73 655 757 427 460 203 292 838 304 897  67 864 682 510  22
22: 811 603 802 515 743 215 384 749 404 681 991 997 398 980 600  23
23: 176 654 819 292 552 818 784 788 297 216 431 291 567  79 591  24
24: 512 660 386 435 935 244 790 334 355 706 907 877  29 257 839  25
25: 994 535 597 517  22 122 422 127 373 287 842 782 296 984 767  26
26: 521 484 501 617 134 189 411 167 805 743   0 737 631 195 858  27
27: 108 537 485 258 195 845 897  75 530 183 302 972 633 169 420  28
28: 712  79 913 106 252 173 980 400  17 298 904 306 895 803 659  29
29: 234  32 991 202 839 899  73 357 833  24 560 479 294 301 937  30
30: 367 995 211 396 931 242  84 573  90 416 714 994 349 240 156  31
31: 491 360 255 601 277 192 964 895 958  99  24 854 811 857 302  32
32: 476 538 919 280  87 829  43 127 125 510 514 197 415 802 993  33
33: 941 369 248  88 876 344 414 575 375 696 890 570 528 709 699  34
34: 812 892 493 808  21 682 662 526 336  25 597 172 904 790 701  35
35: 561 666 557 594 343 159 104 616 753 353 874 925 429 122 838  36
36: 539  73  22 155 170 942 186  37 754  88 402 417 120 674 440  37
37: 434 847 684 529 121 619 438 473 569 112 574 939 592 683  94  38
38: 478 889 507  96 509 509 772 554 214 544  54  59 235 955 293  39
39: 311  52 246  17 275 423 908 626  18  11 874 520  43 492 747  40
40: 328 971 160   8 626  88 161 402 186 272 446 938  92 558 780  41
41: 566 572 947 552   6 377 552 962 781 678 296 579 817 209  11  42
42: 660   6 436 169 860 996  99 125 784  77 392 266 484 194  43  43
43: 617  82 931  72 260 878 281  12 420 722 842 842 340 373 599  44
44:  76 227 585 431 647 658 564 253 110  22 107 204 513 546 892  45
45: 557 652 538 984 530  99  19 996 651   4 460 794 378 802 870  46
46: 529  23 627 231 270 515 841 820 359 562 432 637 303 124 911  47
47: 951 770 783 854 650 666 264  20 622 556 967 216  16   0   0   0
48:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
49:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
50:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

Uwagi

Kosztem obniżenia oceny poprawności rozwiązania o 1 pkt można założyć, że w
poleceniach nawiasy nie są zagnieżdżone a maksymalna liczba sąsiadujących
liczników nie przekracza 4.

Wolno założyć, że dane są poprawne i że podczas pracy kalkulatora nie nastąpi
przepełnienie pamięci.

W tekście wejściowym i wyjściowym każdy wiersz, także ostatni, powinien być
zakończony końcem wiersza.

Wolno założyć, że wiersze na wejściu programu mają nie więcej niż 255 znaków,
czyli mogą być wartością zmiennej typu String.

Prosimy pamiętać o kompilacji programu z opcjami -Ciort -vw -gl ułatwiającymi
znajdowanie błędów w programie.

Poprawność obsługiwanego formatu danych i formatu wyniku można sprawdzić,
przekierowując na wejście programu zawartość dołączonego do treści pliku z
rozszerzeniem .in i porównując wynik z odpowiednim plikiem z rozszerzeniem
.out za pomocą programu diff, np.:

./rozwiazanie <przyklad1.in >moj.out
diff moj.out przyklad1.out

